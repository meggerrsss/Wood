Option Explicit
Sub Send_Mails()
Dim sh As Worksheet

Dim j As Integer

For j=1 To Worksheets.Count  'Start of the VBA loop
	Set sh = Sheets(j).Name   

	Dim iCounter As Integer
	Dim Dest As Variant
	Dim SDest As String

	Dim OA As Object
	Dim msg As Object

	Set OA = CreateObject("outlook.application")
	Set msg = OA.createitem(0)

	With msg
		   SDest = ""
		   For iCounter = 2 To WorksheetFunction.CountA(Columns(2))
			   If SDest = "" Then
				   SDest = Cells(iCounter, 2).Value
			   Else
				   SDest = SDest & ";" & Cells(iCounter, 2).Value
			   End If
		   Next iCounter

		msg.BCC = SDest
		msg.Subject = sh.Cells(2, 3).Value
		msg.body = sh.Cells(2, 4).Value
		msg.To = sh.Cells(2, 1).Value
		msg.display
	End With

	MsgBox sh.Name & ": All the emails have been sent successfully"
Next j

End Sub
